{"version":3,"sources":["useCastChannel.ts"],"names":["useEffect","useState","CastChannel","useCastSession","useCastChannel","namespace","onMessage","castChannel","setCastChannel","castSession","channel","add","then","c","remove","offMessage"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,cAAT,CACbC,SADa,EAEbC,SAFa,EAGO;AACpB,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCP,QAAQ,CAAqB,IAArB,CAA9C;AACA,QAAMQ,WAAW,GAAGN,cAAc,EAAlC;AAEAH,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIU,OAAJ;;AAEA,QAAID,WAAJ,EAAiB;AACfP,MAAAA,WAAW,CAACS,GAAZ,CAAgBF,WAAhB,EAA6BJ,SAA7B,EAAwCO,IAAxC,CAA8CC,CAAD,IAAO;AAClDH,QAAAA,OAAO,GAAGG,CAAV;AACAL,QAAAA,cAAc,CAACK,CAAD,CAAd;AACD,OAHD;AAID,KALD,MAKO;AACLH,MAAAA,OAAO,GAAG,IAAV;AACAF,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD;;AAED,WAAO,MAAM;AAAA;;AACX,kBAAAE,OAAO,UAAP,4CAASI,MAAT;AACD,KAFD;AAGD,GAhBQ,EAgBN,CAACL,WAAD,EAAcJ,SAAd,CAhBM,CAAT;AAkBAL,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACM,SAAL,EAAgB,OADF,CACS;;AAEvBC,IAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAED,SAAb,CAAuBA,SAAvB;AAEA,WAAO,MAAM;AACXC,MAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,YAAAA,WAAW,CAAEQ,UAAb;AACD,KAFD;AAGD,GARQ,EAQN,CAACR,WAAD,EAAcD,SAAd,CARM,CAAT;AAUA,SAAOC,WAAP;AACD","sourcesContent":["import { useEffect, useState } from 'react'\nimport CastChannel from './CastChannel'\nimport useCastSession from './useCastSession'\n\n/**\n * Hook that establishes a custom {@link CastChannel} on the current connected session.\n *\n * @param namespace custom namespace starting with `urn:x-cast:`\n * @param onMessage listener called when a message from the receiver was received\n * @returns custom channel, or `null` if there's no session connected\n * @example\n * ```js\n * import { useCastChannel } from 'react-native-google-cast'\n *\n * function MyComponent() {\n *   const castChannel = useCastChannel(\n *     'urn:x-cast:com.example.custom',\n *     useCallback(message => { console.log('Received message', message) }, [])\n *   )\n *\n *   // later, for example after pressing a button\n *   function onPress() {\n *     if (castChannel) {\n *       castChannel.sendMessage('...')\n *     }\n *   }\n * }\n * ```\n */\nexport default function useCastChannel(\n  namespace: string,\n  onMessage?: (message: Record<string, any> | string) => void\n): CastChannel | null {\n  const [castChannel, setCastChannel] = useState<CastChannel | null>(null)\n  const castSession = useCastSession()\n\n  useEffect(() => {\n    let channel: CastChannel | null\n\n    if (castSession) {\n      CastChannel.add(castSession, namespace).then((c) => {\n        channel = c\n        setCastChannel(c)\n      })\n    } else {\n      channel = null\n      setCastChannel(null)\n    }\n\n    return () => {\n      channel?.remove()\n    }\n  }, [castSession, namespace])\n\n  useEffect(() => {\n    if (!onMessage) return // don't call offMessage when removing the effect\n\n    castChannel?.onMessage(onMessage)\n\n    return () => {\n      castChannel?.offMessage()\n    }\n  }, [castChannel, onMessage])\n\n  return castChannel\n}\n"]}